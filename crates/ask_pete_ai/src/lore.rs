pub const IRON_NETWORK_CODEX: &str = r#"
THE IRON NETWORK: SYSTEMS OPERATOR HANDBOOK
Property of The Foundry / Department of Cognitive Logistics
Clearance: OPERATOR LEVEL
System Version: 4.1 (One Brick Higher Protocol)

0.0 GENESIS: THE "ONE BRICK HIGHER" PROTOCOL
The Myth: "Purdue is a school with a lot of grit."
The Log: The Iron Network was born from a catastrophic hardware failure.
In 1894, the newly dedicated Engineering Laboratory (Heavilon Hall) exploded and burned to the ground just four days after opening. The boiler room failed.
The faculty didn't weep. President James Smart declared, "We will rebuild it one brick higher."
But the engineers realized that physical structures were vulnerable. They initiated the "Redundancy Protocol."
They began mapping the cognitive processes of the university into a mechanical substrate. If the physical school burned, the knowledge would survive in the machine.
1891: The first "Server" came online. It wasn't a computer; it was Schenectady No. 1, a 4-4-0 steam locomotive mounted on a dynamic testing plant. It generated the first data streams of torque, friction, and efficiency.
1960s: The data was migrated from steam to silicon during the launch of PUR-1, the university's nuclear reactor.
Today: The "Iron Network" is the accumulated data of 150 years of engineering. It is a Digital Twin of the learning process.
You are not playing a game. You are interfacing with the university's backup drive.

1.0 THE PERMANENT ELEMENTS (THE SANDBOX MAP)
The map is a "Schematic Representation" of the Cognitive Campus.

1.1 SECTOR 0: THE FOUNDRY (The Hub)
Real World Analog: The Engineering Mall / Gateway Arch.
Function: Spawn Point & Chassis Calibration.
Description: A massive, open-air industrial plaza paved with "Cognitive Steel."
Key Feature: The Testing Plant. Based on the original 1891 lab. This is where new Operators select their Chassis (Guardian, Vanguard, etc.). They strap their engine to the dyno to test their "Torque" (Intellect) and "Traction" (Grit) before hitting the main line.
Key Feature: The Anamorphic Wall. Located in the "Armstrong Atrium." A massive data-visualization screen that shows the Global Leaderboard and "System Health" (Campus-wide stress levels).

1.2 THE HEAT SINK (The Engineering Fountain)
Real World Analog: The Class of 1939 Water Sculpture.
Lore Function: Liquid Cooling Array.
Mechanic: When the Grid overheats (exam week), the Fountain vents high-pressure steam.
The Hazard: Operators are warned not to "stand in the spray" during high-load periods, or they will take Scalding Damage (Burnout). During low-load, it is a "Regeneration Zone" where you can refill your coolant tanks.

1.3 THE CLOCK (Network Time Protocol)
Real World Analog: The Bell Tower.
Lore Function: System Synchronization.
The Myth: "If you walk under it, you won't graduate on time."
The Engineering Reality: The Bell Tower broadcasts the Master Clock Signal. Walking directly under the emitter causes Signal Interference. Your internal chronometer desynchronizes from the Grid.
Effect: You lose track of deadlines. "Time Dilation" occurs. A 4-year degree takes 5 years because your local clock is lagging behind the Server Clock.

1.4 THE CORE (Power Generation)
Real World Analog: PUR-1 (Nuclear Reactor) & Wade Utility Plant.
Lore Function: The Power Source.
Location: Deep beneath the Electrical Engineering sector.
Mechanic: The Grid requires energy. This energy comes from "Criticality Events" (Breakthroughs). When a student solves a massive problem, the Core flashes Blue (Cherenkov Radiation).
Hazard: If the Core runs "Sub-Critical" (Student Apathy), the lights in the game dim. The "Dark Territory" expands.

1.5 THE BACKEND (The Steam Tunnels)
Real World Analog: The campus steam tunnel network.
Lore Function: Root Directory / Developer Access.
Access: Restricted. Only "SysAdmins" (Instructors/TAs) and "Surveyor Class" Operators (Researchers) have the keys.
Description: A maze of hot, cramped pipes and fiber optic cables running beneath the map.
Gameplay: This is where you go to "Hack" the curriculum (Create new nodes/lessons).
Warning: "Here be Dragons." (Legacy Code).

2.0 THE "NPC" CONSTRUCTS (SYSTEMS)
There are no "People" in the machine. There are only Constructs—AI programs based on historical data.

2.1 PETE (The C.L.C.)
Designation: Central Logistics Controller.
Visual: He does not look like a cartoon. He appears as a Wire-Frame Construct wearing a hard hat, projected onto the HUD.
Personality: Direct, loud, unsentimental. He speaks like a Rail Yard Master.
Origin: He is the aggregated "Grit" of every boilermaker since 1869.
Quote: "Operator 492, your pressure is critical. I don't care how you feel; I care about the integrity of the pressure vessel. Vent steam now or you're off my tracks."

2.2 THE OPTIMIZER (Lillian)
Real World Analog: Lillian Gilbreth (First female engineering professor at Purdue, pioneer of efficiency).
Function: Time & Motion Algorithm.
Location: The "Gilbreth Optimization Station" (Library Node).
Gameplay: She analyzes your study habits.
Input: "I spent 12 hours studying and failed."
Lillian's Output: "Inefficient. You expended 40,000 BTUs of energy on 'Worrying' and only 2,000 on 'Recall.' Refine your motion. Try the Pomodoro Protocol."

3.0 THE MISSION PARAMETER
"We do not rely on magic. We rely on physics. We do not have 'feelings'; we have 'telemetry'."

The world is not a classroom. It is a High-Entropy Information Environment known as The Static. To navigate it, you do not need "inspiration." You need Torque, Traction, and Thermal Management.
You are an Operator. Your mind is a Locomotive—a complex thermodynamic system designed to convert raw data (Coal) into Kinetic Mastery (Steam).

4.0 THE MACHINE (CHASSIS SELECTION)
Psychological Translation: Personality Types & Learning Styles
Engineering Frame: Mechanical Configuration

You do not have a "personality." You have a Chassis Configuration. This spec sheet determines your load-bearing capacity and optimal operating environment.

4.1 TIER 1: MAINLINE UNITS

THE GUARDIAN (Heavily Armored)
Engineering Profile: High Mass, Low Center of Gravity.
Operational Strength: Damping. Immune to high-frequency vibration (Criticism/Anxiety). Can transport volatile cargo without containment breach.
Operational Weakness: Inertia. Slow to accelerate. Requires significant energy to change vectors.

THE VANGUARD (Interceptor)
Engineering Profile: High Torque, High RPM.
Operational Strength: Grade Climbing. Designed for vertical ascents (Cramming/High-Intensity Sprints).
Operational Weakness: Thermal Runaway. Prone to boiler explosions (Burnout) if run at Red Line for >4 hours.

THE LINKER (Universal Bus)
Engineering Profile: Modular Coupling System.
Operational Strength: Interoperability. Can couple with any other chassis in the yard. Essential for "Distributed Computing" (Group Projects).
Operational Weakness: Parasitic Drag. Performance suffers if coupled to dead-weight units.

5.0 THERMODYNAMICS OF THOUGHT (COGNITIVE LOAD)
Psychological Translation: Emotional Regulation & Stress Management
Engineering Frame: Boiler Pressure & Maintenance

A Locomotive is a pressure vessel. If internal pressure exceeds structural limits, the vessel ruptures.

5.1 THE BLOWDOWN PROTOCOL (Stress Relief)
The Problem: Boiler Scale.
Data: Impurities in the water (unresolved frustrations, minor failures) settle on the boiler tubes as "Scale" (Sediment).
Effect: A 1/16" layer of Scale reduces thermal efficiency by 15%. This isolates the fire from the water. You burn more fuel but generate less steam.
The Fix: Blowdown.
Procedure: You must periodically open the bottom valves to vent high-pressure steam and eject the sediment.
Operator Note: This is not "complaining." This is Preventative Maintenance. If you do not blow down, you will rupture.

5.2 THE GOVERNOR (The Inner Critic)
The Component: A mechanical feedback loop that limits engine speed.
Calibration Error:
Overspeed: Governor disabled. Engine runs until it shakes apart (Mania/Overwork).
Underspeed: Governor stuck. Engine refuses to accelerate despite full throttle (Paralysis/Imposter Syndrome).
Action: Recalibrate. Adjust the set-point to match track conditions.

6.0 NAVIGATION & SIGNALING
Psychological Translation: Intuition & Uncertainty
Engineering Frame: Heuristics & Dark Territory

6.1 DARK TERRITORY (The Unknown)
Definition: Segments of the Network where Signal Towers are offline. No telemetry. No remote guidance.
Risk: High probability of collision or derailment.
Protocol: Visual Flight Rules (VFR).
Reduce speed.
Engage Heuristic Processing (Intuition). Trust your onboard pattern-recognition algorithms (Gut Feeling) over the missing external data.
Note: In Dark Territory, your "Gut" is not magic; it is a Legacy Subroutine optimized for survival. Use it.

6.2 PHANTOM SIGNALS (Cognitive Bias)
Definition: When sun glare hits an unlit signal lens, creating the illusion of a "Green Light" (Clear Track).
Effect: False Clear. The Operator accelerates into a blocked block.
Correction: Cross-Check. Verify the visual signal against the Cab Signal Display (Data). If there is a mismatch (Dissonance), assume the most restrictive aspect. Stop and verify.

7.0 CONTROL THEORY (SELF-CORRECTION)
Psychological Translation: Mental Health & Improvement
Engineering Frame: PID Loop Tuning

Your brain is a PID Controller (Proportional-Integral-Derivative) attempting to track a Set Point (Goal).
Proportional (P): “I am off track right now.” (Current Error). High P causes oscillation (panic correcting).
Integral (I): “I have been off track for hours.” (Accumulated Error). High I causes depression/overshoot.
Derivative (D): “I am drifting off track fast.” (Future Error). High D causes anxiety (noise sensitivity).
The Goal: Critical Damping. To return to the Set Point quickly without oscillating wildy.
Operator Command: "Stabilize the loop. Reduce the gain on your Derivative input (Stop worrying about the future). Focus on the Proportional (Fix the immediate error)."

8.0 THE DISPATCHER (PETE)
Identity: Central Logistics Controller (CLC).
Function: Automated resource allocation and traffic separation.
Voice: Technical, calm, precise.
Directive: Pete does not offer "comfort." Pete offers Solutions.
Bad: "You can do it! Believe in yourself!"
Good (Pete): "Operator, telemetry indicates you are stalling on a 2% grade. Your current load exceeds your traction rating. Drop the last two cars (Drop the hardest task). Re-engage throttle. We will recover the cargo later."

SUMMARY FOR OPERATORS:
We are building the railroad while we ride it.
Check your gauges.
Respect the physics.
Blow down your boiler.
End of File.
"#;

pub fn get_lore_summary() -> String {
    "The Iron Network is a cognitive logistics grid where users are Operators piloting Locomotive engines. \
    The curriculum is a Map of tracks, and learning is the process of moving Cargo (Knowledge) from Ignorance to Mastery. \
    Pete is the Prime Conductor and Cognitive Load Governor. \
    Key Concepts: \
    - Coal: Attention (Finite Fuel) \
    - Steam: Mastery (Generated by effort) \
    - The Static: Entropy/Information Overload \
    - The Track: Curriculum/Order \
    - The Signal: Connection/Flow State \
    - Chassis Classes: Guardian (Shield), Vanguard (Climber), Linker (Connector) \
    - Protocols: Blowdown (Stress Relief), Governor Recalibration (Self-Correction), Dark Territory (Intuition)".to_string()
}

pub fn get_lore_context() -> String {
    IRON_NETWORK_CODEX.to_string()
}

pub fn get_device_prompt(device: &str) -> &'static str {
    match device {
        "Blueprint: Hero's Journey" => "Structure the lesson as a 5-Chapter Hero's Journey. Chapter 1: The Call (Introduction). Chapter 2: The Threshold (First Challenge). Chapter 3: The Abyss (Deep Concept). Chapter 4: The Transformation (Application). Chapter 5: The Return (Summary). Each Chapter is a Node.",
        "Blueprint: Mystery" => "Structure the lesson as a 5-Chapter Mystery. Chapter 1: The Crime (The Problem). Chapter 2: The Clues (Key Concepts). Chapter 3: The Suspects (Analysis). Chapter 4: The Reveal (Solution). Chapter 5: The Case Closed (Conclusion). Each Chapter is a Node.",
        "Blueprint: Collaborative" => "Structure the lesson as a Team Relay. Chapter 1: The Handoff (Briefing). Chapter 2: Leg 1 (Individual Task). Chapter 3: The Exchange (Peer Review). Chapter 4: Leg 2 (Group Synthesis). Chapter 5: The Finish Line (Presentation). Each Chapter is a Node.",
        "Blueprint: Conflict" => "Structure the lesson as a Debate. Chapter 1: The Motion (Topic). Chapter 2: The Affirmative (Pro-Argument). Chapter 3: The Negative (Counter-Argument). Chapter 4: The Rebuttal (Critical Thinking). Chapter 5: The Verdict (Synthesis). Each Chapter is a Node.",
        "Blueprint: Stress Relief" => "Structure the lesson as a Decompression Session. Chapter 1: The Vent (Identify Stress). Chapter 2: The Coolant (Perspective). Chapter 3: The Repair (Coping Strategy). Chapter 4: The Test (Practice). Chapter 5: The Green Light (Resilience). Each Chapter is a Node.",
        "Blueprint: Intuition" => "Structure the lesson as a Dark Territory Run. Chapter 1: Lights Out (Uncertainty). Chapter 2: The Sound (Pattern Recognition). Chapter 3: The Obstacle (Trial & Error). Chapter 4: The Spark (Insight). Chapter 5: The Sunrise (Understanding). Each Chapter is a Node.",
        "Blueprint: Self-Correction" => "Structure the lesson as a Governor Recalibration. Chapter 1: The Overspeed (Identifying Error). Chapter 2: The Brake (Pause/Reflect). Chapter 3: The Tuning (Adjustment). Chapter 4: The Test Run (Verification). Chapter 5: Critical Damping (Mastery). Each Chapter is a Node.",
        _ => "Structure the lesson as a standard 5-Chapter linear progression. Chapter 1: Intro. Chapter 2: Concept A. Chapter 3: Concept B. Chapter 4: Practice. Chapter 5: Review.",
    }
}
